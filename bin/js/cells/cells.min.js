/**
* Cells
* 2014-07-10
*/
function randInt(a,b){return Math.floor(Math.random()*(b-a+1))+a}function Sketch(a){this.backgroundColor="#29AADF"|a.backgroundColor,this.paintColor="white"|a.paintColor,this.screens={}}function Frame(a){this.width=a.width,this.height=a.height,this.frame=[];for(var b=0;b<this.height;b++){this.frame.push([]);for(var c=0;c<this.width;c++)this.frame[b].push(!1)}}function Pixel(a,b,c){this.circle=new Path.Circle({parent:a.grid,center:[a.margin*b*2+a.unit+a.offset.x+2*b,a.margin*c*2+a.unit+a.offset.y+2*c],radius:a.unit,strokeColor:"white",fillColor:"white"}),this.circle.onMouseDown=function(){this.flip(),this.paint(paintColor)},this.circle.flip=function(){this.fillColor.alpha=1-this.fillColor.alpha},this.circle.on=function(){this.fillColor.alpha=1},this.circle.off=function(){this.fillColor.alpha=0},this.circle.set=function(a){this.fillColor.alpha=a},this.circle.paint=function(a){var b=this.fillColor.alpha;this.fillColor=a,this.fillColor.alpha=b},this.circle.strokeColor.alpha=.5,this.circle.fillColor.alpha=0}function Display(a){this.unit=a.unit,this.width=a.width,this.height=a.height,this.grid=new Layer,this.margin=void 0===a.margin?this.unit:a.margin,this.offset=void 0===a.offset?{x:0,y:0}:a.offset,this.pixels=[];for(var b=0;b<=this.height;b++){this.pixels.push([]);for(var c=0;c<this.width;c++)this.pixels[b].push(new Pixel(this,c,b))}this.grid.position.x=view.center.x+this.offset.x,this.grid.position.y=view.center.y+this.offset.y}paintColor="white",Frame.prototype.draw=function(){for(var a=0;a<this.height;a++)for(var b=0;b<this.width;b++)this.frame[a][b]?this.parent.pixels[a][b].on():this.parent.pixels[a][b].off()},Frame.prototype.on=function(a,b){this.frame[b][a]=!0},Frame.prototype.off=function(a,b){this.frame[b][a]=!1},Display.prototype.clear=function(){this.pixels.forEach(function(a){a.forEach(function(a){a.off()})})},Display.prototype.hideGrid=function(){this.pixels.forEach(function(a){a.forEach(function(a){a.circle.strokeColor.alpha=0})})},Display.prototype.setGridColor=function(a){this.pixels.forEach(function(b){b.forEach(function(b){b.circle.strokeColor=a})})};var sketchWidth=$("#cells").width(),sketchHeight=$("#cells").height(),maxCellsX=parseInt(sketchWidth/42)-2,maxCellsY=parseInt(sketchHeight/42)-2;cellsGrid=new Display({width:maxCellsX,height:maxCellsY,unit:20,margin:21}),linksGrid=new Display({width:maxCellsX-1,height:maxCellsY-1,unit:9,margin:21});